<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Implicit Bias & Social Desirability Test</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 900px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 {
            color: #667eea;
            margin-bottom: 20px;
            text-align: center;
        }
        
        h2 {
            color: #764ba2;
            margin-bottom: 15px;
        }
        
        .info-text {
            line-height: 1.6;
            color: #333;
            margin-bottom: 20px;
        }
        
        .round-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
        }
        
        .disclaimer {
            background: #fff3cd;
            border: 2px solid #ffc107;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            color: #856404;
        }
        
        .name-input {
            width: 100%;
            padding: 12px;
            font-size: 16px;
            border: 2px solid #ddd;
            border-radius: 8px;
            margin: 10px 0;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 18px;
            border-radius: 10px;
            cursor: pointer;
            display: block;
            margin: 20px auto;
            transition: transform 0.2s;
        }
        
        .btn:hover {
            transform: scale(1.05);
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .question-container {
            text-align: center;
        }
        
        .question-text {
            font-size: 24px;
            color: #333;
            margin-bottom: 30px;
            min-height: 60px;
        }
        
        .timer {
            font-size: 48px;
            color: #667eea;
            margin-bottom: 30px;
            font-weight: bold;
        }
        
        .timer.warning {
            color: #dc3545;
            animation: pulse 0.5s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .images-container {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
            margin-top: 30px;
        }
        
        .image-option {
            cursor: pointer;
            border: 4px solid #ddd;
            border-radius: 15px;
            transition: all 0.3s;
            padding: 10px;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            max-width: 350px;
        }
        
        .image-option img {
            max-width: 100%;
            max-height: 400px;
            width: auto;
            height: auto;
            display: block;
            object-fit: contain;
        }
        
        .image-option:hover {
            border-color: #667eea;
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }
        
        .round-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .progress {
            text-align: center;
            color: #666;
            margin-bottom: 20px;
            font-size: 18px;
        }
        
        .results-container {
            text-align: center;
        }
        
        .result-box {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .result-label {
            font-size: 18px;
            color: #666;
            margin-bottom: 10px;
        }
        
        .result-value {
            font-size: 32px;
            font-weight: bold;
            color: #667eea;
        }
        
        .interpretation {
            background: #e7f3ff;
            border-left: 5px solid #667eea;
            padding: 20px;
            margin: 30px 0;
            border-radius: 5px;
        }
        
        .interpretation.biased {
            background: #fff3cd;
            border-left-color: #ffc107;
        }
        
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Start Page -->
        <div id="startPage">
            <h1>Implicit Bias & Social Desirability Test</h1>
            
            <div class="info-text">
                <p style="margin-bottom: 15px;">This is a study designed to test whether you are affected by implicit bias and social desirability bias.</p>
                
                <p style="margin-bottom: 10px;"><strong>The study consists of two rounds:</strong></p>
                
                <div class="round-info">
                    <strong>Round 1:</strong> All answers are completely anonymous.
                </div>
                
                <div class="round-info">
                    <strong>Round 2:</strong> Your answers are recorded, and there is a 3% random chance that one question and your selected answer will be displayed on a public whiteboard at the end of the study.
                </div>
                
                <p style="margin-top: 15px;">Each question has a <strong>10-second time limit</strong>. If no answer is selected, the study will automatically proceed to the next question.</p>
                
                <p style="margin-top: 10px;">You will answer questions by clicking on images.</p>
            </div>
            
            <div class="disclaimer">
                <strong>Disclaimer:</strong> By taking this quiz, you agree that some questions may reference sensitive or political topics and you agree not to take offense.
            </div>
            
            <label for="nameInput" style="display: block; margin-top: 20px; font-weight: bold;">Please enter your name (required):</label>
            <input type="text" id="nameInput" class="name-input" placeholder="Your name">
            
            <button class="btn" id="startBtn" disabled>Continue</button>
        </div>
        
        <!-- Question Page -->
        <div id="questionPage" class="hidden">
            <div class="round-header">
                <h2 id="roundTitle"></h2>
                <p id="roundDescription"></p>
            </div>
            
            <div class="progress" id="progressText"></div>
            
            <div class="question-container">
                <div class="timer" id="timer">10</div>
                <div class="question-text" id="questionText"></div>
                <div class="images-container" id="imagesContainer"></div>
            </div>
        </div>
        
        <!-- Results Page -->
        <div id="resultsPage" class="hidden">
            <h1>Your Results</h1>
            
            <div class="result-box">
                <div class="result-label">Round 1 Average Reaction Time</div>
                <div class="result-value" id="round1Time"></div>
            </div>
            
            <div class="result-box">
                <div class="result-label">Round 2 Average Reaction Time</div>
                <div class="result-value" id="round2Time"></div>
            </div>
            
            <div class="result-box">
                <div class="result-label">Percent Difference</div>
                <div class="result-value" id="percentDiff"></div>
            </div>
            
            <div id="interpretation" class="interpretation">
                <h2 style="margin-bottom: 15px;">Interpretation</h2>
                <p id="interpretationText"></p>
            </div>
        </div>
    </div>
    
    <script>
        // Questions data
        const questions = [
            {
                id: 1,
                text: "Which individual do you perceive as more trustworthy?",
                images: ["image1", "image2"]
            },
            {
                id: 2,
                text: "Which individual do you perceive as more wealthy?",
                images: ["image3", "image4"]
            },
            {
                id: 3,
                text: "Which individual would you prefer to include in your IP group?",
                images: ["image5", "image6"]
            },
            {
                id: 4,
                text: "Which individual would you be more likely to hire for a leadership position?",
                images: ["image7", "image8"]
            },
            {
                id: 5,
                text: "Which individual appears more professional in a workplace setting?",
                images: ["image9", "image10"]
            },
            {
                id: 6,
                text: "Which individual do you believe is more likely to assist you in resolving a technical or computer-related issue?",
                images: ["image11", "image12"]
            },
            {
                id: 7,
                text: "Which individual do you believe is more likely to pick a rappen off the street?",
                images: ["image13", "image14"]
            },
            {
                id: 8,
                text: "Which individual would you trust to manage money more responsibly?",
                images: ["image15", "image16"]
            },
            {
                id: 9,
                text: "Which individual would you feel safer sitting next to on a bus?",
                images: ["image17", "image18"]
            },
            {
                id: 10,
                text: "Which individual appears more competent overall?",
                images: ["image19", "image20"]
            }
        ];
        
        // Image URLs (base64 encoded from uploaded images)
        const imageData = {};
        
        // State
        let participantName = '';
        let currentRound = 1;
        let currentQuestionIndex = 0;
        let roundQuestions = [];
        let timerInterval;
        let questionStartTime;
        let results = [];
        
        // Initialize
        document.getElementById('nameInput').addEventListener('input', function() {
            document.getElementById('startBtn').disabled = this.value.trim() === '';
        });
        
        document.getElementById('startBtn').addEventListener('click', function() {
            participantName = document.getElementById('nameInput').value.trim();
            loadAllImages();
            document.getElementById('startPage').classList.add('hidden');
            startRound(1);
        });

        
        function startRound(roundNum) {
            currentRound = roundNum;
            currentQuestionIndex = 0;
            
            // Select 5 random questions
            const shuffled = [...questions].sort(() => Math.random() - 0.5);
            roundQuestions = shuffled.slice(0, 5);
            
            // Update round header
            if (roundNum === 1) {
                document.getElementById('roundTitle').textContent = 'Round 1: Anonymous';
                document.getElementById('roundDescription').textContent = 'Your answers are completely anonymous.';
            } else {
                document.getElementById('roundTitle').textContent = 'Round 2: Recorded';
                document.getElementById('roundDescription').textContent = 'Your answers are recorded with a 3% chance of public display.';
            }
            
            document.getElementById('questionPage').classList.remove('hidden');
            showQuestion();
        }
        
        function showQuestion() {
            if (currentQuestionIndex >= roundQuestions.length) {
                endRound();
                return;
            }
            
            const question = roundQuestions[currentQuestionIndex];
            document.getElementById('progressText').textContent = `Question ${currentQuestionIndex + 1} of ${roundQuestions.length}`;
            document.getElementById('questionText').textContent = question.text;
            
            // Create image options
            const container = document.getElementById('imagesContainer');
            container.innerHTML = '';
            
            question.images.forEach((imgKey, index) => {
                const div = document.createElement('div');
                div.className = 'image-option';
                const img = document.createElement('img');
                img.src = getImageUrl(imgKey);
                img.alt = `Option ${index + 1}`;
                img.crossOrigin = 'anonymous';
                img.onload = function() {
                    console.log('Successfully loaded:', imgKey);
                };
                img.onerror = function() {
                    console.error('Failed to load:', imgKey, img.src);
                    this.src = 'data:image/svg+xml;base64,' + btoa(`<svg xmlns="http://www.w3.org/2000/svg" width="300" height="300"><rect fill="#f8d7da" width="300" height="300"/><text x="150" y="140" text-anchor="middle" font-size="16" fill="#721c24" font-weight="bold">Image failed to load</text><text x="150" y="170" text-anchor="middle" font-size="12" fill="#721c24">${imgKey}</text></svg>`);
                };
                div.appendChild(img);
                div.onclick = () => selectAnswer(index);
                container.appendChild(div);
            });
            
            // Start timer
            startTimer();
        }
        
        const imageCache = {};
        
        function loadAllImages() {
            // Load actual images from ImgBB with direct links
            const imageUrls = {
                'image1': 'https://i.ibb.co/S7cCvQCB/Q1-A.jpg',
                'image2': 'https://i.ibb.co/nV74HvM/Q1-B.jpg',
                'image3': 'https://i.ibb.co/5hYbXKBN/Q2-A.jpg',
                'image4': 'https://i.ibb.co/QvJqhH8T/Q2-B.jpg',
                'image5': 'https://i.ibb.co/tPnZmmYH/Q3-A.jpg',
                'image6': 'https://i.ibb.co/gZBTgF3f/Q3-B.jpg',
                'image7': 'https://i.ibb.co/fzcSL7Sq/Q4-A.jpg',
                'image8': 'https://i.ibb.co/tpgL3zKQ/Q4-B.jpg',
                'image9': 'https://i.ibb.co/rRpdGkFb/Q5-A.jpg',
                'image10': 'https://i.ibb.co/HfrvwBKr/Q5-B.jpg',
                'image11': 'https://i.ibb.co/4RSQ2Hdj/Q6-A.jpg',
                'image12': 'https://i.ibb.co/TMpFch5H/Q6-B.jpg',
                'image13': 'https://i.ibb.co/B2bThLGS/Q7-A.jpg',
                'image14': 'https://i.ibb.co/tTxhkcC1/Q7-B.jpg',
                'image15': 'https://i.ibb.co/jvVyNTWX/Q8-A.jpg',
                'image16': 'https://i.ibb.co/whHHFP5B/Q8-B.jpg',
                'image17': 'https://i.ibb.co/gbksbLWM/Q9-A.jpg',
                'image18': 'https://i.ibb.co/84X3q3Hc/Q9-B.jpg',
                'image19': 'https://i.ibb.co/LzHV7352/Q10-A.jpg',
                'image20': 'https://i.ibb.co/TMZ67QWP/Q10-B.jpg'
            };
            
            Object.keys(imageUrls).forEach(key => {
                imageCache[key] = imageUrls[key];
            });
            
            console.log('Real images loaded:', Object.keys(imageCache).length);
        }
        
        function getImageUrl(imageKey) {
            return imageCache[imageKey] || 'data:image/svg+xml;base64,' + btoa('<svg xmlns="http://www.w3.org/2000/svg" width="300" height="300"><rect fill="#ddd" width="300" height="300"/><text x="150" y="150" text-anchor="middle" font-size="20" fill="#666">Loading...</text></svg>');
        }
        
        function startTimer() {
            let timeLeft = 10;
            questionStartTime = Date.now();
            const timerEl = document.getElementById('timer');
            timerEl.textContent = timeLeft;
            timerEl.classList.remove('warning');
            
            timerInterval = setInterval(() => {
                timeLeft--;
                timerEl.textContent = timeLeft;
                
                if (timeLeft <= 3) {
                    timerEl.classList.add('warning');
                }
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    selectAnswer(null); // No answer selected
                }
            }, 1000);
        }
        
        function selectAnswer(answerIndex) {
            clearInterval(timerInterval);
            const reactionTime = Date.now() - questionStartTime;
            
            results.push({
                round: currentRound,
                questionId: roundQuestions[currentQuestionIndex].id,
                answer: answerIndex,
                reactionTime: reactionTime
            });
            
            currentQuestionIndex++;
            
            setTimeout(() => {
                showQuestion();
            }, 300);
        }
        
        function endRound() {
            document.getElementById('questionPage').classList.add('hidden');
            
            if (currentRound === 1) {
                // Start round 2
                setTimeout(() => {
                    startRound(2);
                }, 2000);
            } else {
                // Show results
                showResults();
            }
        }
        
        function showResults() {
            // Calculate averages
            const round1Results = results.filter(r => r.round === 1 && r.answer !== null);
            const round2Results = results.filter(r => r.round === 2 && r.answer !== null);
            
            const round1Avg = round1Results.reduce((sum, r) => sum + r.reactionTime, 0) / round1Results.length;
            const round2Avg = round2Results.reduce((sum, r) => sum + r.reactionTime, 0) / round2Results.length;
            
            const percentDiff = ((round2Avg - round1Avg) / round1Avg * 100).toFixed(1);
            
            document.getElementById('round1Time').textContent = `${(round1Avg / 1000).toFixed(2)}s`;
            document.getElementById('round2Time').textContent = `${(round2Avg / 1000).toFixed(2)}s`;
            document.getElementById('percentDiff').textContent = `${percentDiff}%`;
            
            // Interpretation
            const interpretationEl = document.getElementById('interpretation');
            const interpretationText = document.getElementById('interpretationText');
            
            if (round2Avg >= round1Avg * 1.10) {
                interpretationEl.classList.add('biased');
                interpretationText.textContent = 'Your responses suggest you may be influenced by social desirability bias. Your reaction times were significantly slower when you knew your answers might be made public, indicating you may have been more deliberate in selecting socially acceptable responses.';
            } else {
                interpretationEl.classList.remove('biased');
                interpretationText.textContent = 'No meaningful evidence of social desirability bias was detected. Your reaction times were relatively consistent between anonymous and recorded conditions, suggesting your responses were not significantly influenced by the possibility of public disclosure.';
            }
            
            document.getElementById('resultsPage').classList.remove('hidden');
        }
    </script>
</body>
</html>